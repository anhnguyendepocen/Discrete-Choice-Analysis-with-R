---
title: "05 Behavioral interpretation"
output: html_notebook
---

# Behavioral interpretation {#chapter-5}

>  "In theory, there is no difference between theory and practice. But in practice, there is."
>
> --- Benjamin Brewster


> "An ounce of practice is generally worth more than a ton of theory.
>
> --- E.F. Schumacher

## Theory and practice

Chapters \@ref(chapter-2) and \@ref(chapter-3) presented a conceptual framework (a theory of behavior) and the necessary apparatus (based on probability theory) to implement the conceptual framework. This theoretical introduction was necessary to begin work from a solid foundation, and it provides an intuitive and elegant framework to study decision-making, and a powerful one too; Daniel McFadden was awarded the Sveriges Riksbank Prize in Economic Sciences (Nobel Prize)[https://www.nobelprize.org/prizes/economic-sciences/2000/mcfadden/diploma/] for his contributions to random utility modelling.

Although not described in detail in previous chapters, it is worthwhile to dwell for a moment on the history of the development of the logit model as a random utility model.

In his Nobel Lecture, [McFadden](https://en.wikipedia.org/wiki/Daniel_McFadden) [-@McFadden2001economic] recounts the path that led to the development of random utility models for discrete choices. Like most important discoveries, it is a meandering path. It began early in the 20th century with a theory for economic behavior (i.e., utility) that considered heterogeneous preferences that in practice were difficult to verify empirically because of data limitations. Indeed, studies before the 1960s mostly considered aggregated demand with representative agents (i.e., archetypical consumers) to accommodate this limitation in data availability. It was only when individual-level data became more widely collected and within reach of researchers that it became possible to pay attention to the behavior of individual agents. 

While economists were busy with models of aggregated demand, research in psychometrics and mathematical psychology by [L.L Thurstone](https://en.wikipedia.org/wiki/Louis_Leon_Thurstone) and [R.D. Luce](https://en.wikipedia.org/wiki/R._Duncan_Luce) was busy providing the technical basis for modelling what Thurstone termed _Comparative Judgement_ (in the sense of making a decision or forming an opinion). In particular, Luce introduced the axiom of Independence of Irrelevant Alternatives (discussed in Chapter \@ref(chapter-3)). According to McFadden (2001, p. 353), this axiom "simplified experimental collection of choice data by allowing multinomial choice probabilities to be inferred from binomial choice experiments." [J. Marschak](https://en.wikipedia.org/wiki/Jacob_Marschak) was the first to introduce the work of Thurstone to econometrics in 1960, and also the author of the term _Random Utility Maximizing_ (RUM) that eventually prevailed over the comparative judgement terminology of Thurstone. McFadden's early contributions to this body of research was developing an econometric version of Luce's model, with strict (i.e., systematic) utilities specified as functions of the attributes of the alternatives and linking unobserved preference
heterogeneity to a fully consistent description of the distribution of demands. Since the 1970s, discrete choice analysis has been a burgeoning area of research with a plethora of applications in economics, marketing, and travel behavior, among many others.

This brief story neatly illustrates the complex interplay between theory and practice.

Early attempts to study demand were limited due to practical considerations (i.e., the absence of data at the individual level). Once appropriate data became available, new studies continued to push the theoretical envelope. Indeed, theoretical questions have continued to inspire newer way to collect data and novel methods, and these in turn have helped us to refine our understanding of behavior. See as an example the work on decision-making in social situations [@Akerlof1997social; @Axhausen2005social; @Paez2007social] which inspired the use of new data sources [e.g., @Carrasco2007social @Axhausen2008social; @Scott2012social; @Chen2016social] as well as novel modelling approaches [e.g., @Dugundji2005discrete; @Dugundji2013social; @Kamargianni2014social] and empirical work [e.g., @vandenBerg2009social; @Goetzke2011bicycle; @Matous2017social].

Now that the preceding chapters have armed us with the theory and basic concepts to implement random utility modelling, it is proper that we turn our attention to the practical aspects of modelling. The best way to ensure that the concepts take hold, in my view, is to get your hands on a dataset and struggle with the practicalities of cleaning and organizing data, specifying the utility functions (a task that is more art than science), and estimating models. These skills are mostly transferable to other modelling techniques, so we will begin by applying them to the most fundamental discrete choice model, the multinomial logit.  

## How to use this note

Remember that the source for the document you are reading is an R Notebook. Throughout the notes, you will find examples of code in segments of text called _chunks_. This is an example of a chunk:
```{r}
print("Hats off to you, Prof. McFadden")
```

If you are working with the Notebook version of the document, you can run the code by clicking the 'play' icon on the top right corner of the chunk. If you are reading the web-book version of the document, you will often see that the code has already been executed. You can still try it by copying and pasting into your R or RStudio console.

## Learning objectives

In this practice, you will learn about:

1. The Extreme Value distribution.
2. The binary logit model.
3. The multinomial logit model. 
4. Properties of the logit model.

## Suggested readings

- Ben-Akiva, M. Lerman, [-@Benakiva1985discrete] Discrete Choice Analysis: Theory and Applications to Travel Demand, **Chapters 4 and 5**, MIT Press.
- Hensher, D.A., Rose, J.M., Greene, W.H [-@hensher2005applied] Applied Choice Analysis: A Primer, **Chapter 10**, Cambridge University Press.
- Ortuzar JD, Willumsen LG [-@Ortuzar2011modelling] Modelling Transport, Fourth Edition, **Chapter 8**, John Wiley and Sons.
- Train [-@Train2009discrete] Discrete Choice Methods with Simulation, Second Edition, **Chapter 3**, Cambridge University Press.

## Preliminaries

Load the packages used in this section:
```{r}
library(tidyverse)
library(evd)
library(mlogit)
library(kableExtra)
library(plotly)
```

Load the dataset used in this section:
```{r}
load("Commute Mac.RData")
```

## The meaning of the coefficients

The coefficients of a model are informative because they modulate the effect of various variables on the probabilities of selecting alternatives. In addition, they also can be used to understand how decision-makers trade-off different attributes. 

We can explore these 

### Marginal effects

### Marginal rate of substitution

### Elasticities


This is what is termed a _marginal rate of substitution_.

Suppose that we would like to know at what rate consumers would be willing to trade one aspect of the good for another, whithout compromising the utility they derive from making a choice. In effect we would like to know how changes in one attribute, say $x_1$, relate to changes in the other, say $x_2$, while maintaing the utility constant (i.e., the change in utility is zero):
$$
\partial U = 0 = \beta_1\partial x_{1} + \beta_2\partial  x_{2}
$$

It follows then that:
$$
-\frac{\partial ic}{\partial oc} = \frac{\beta_2}{\beta_1}
$$

The ratio of the coefficients represents the willingness to pay. In this example, since:
$$
-\frac{\partial ic}{\partial oc} = \frac{\beta_2}{\beta_1} = \frac{-0.0069}{-0.0015} = 4.56
$$

The willingness to pay is an additional 4.56 dollars in installation costs per every dollar of operation cost per year. The discount rate is:
$$
r = \frac{1}{4.56} = 0.22 = 21.9\%
$$

This information can be used now to assess consumer behavior. This is similar to the purpose of the hedonic analysis method, which aims to tease out the willingness to pay (i.e., implicit price) of attributes in a composite good.








## Exercise

Answer the following questions.

### Questions

1. What do we mean when we say that the logit probability has a closed form?

2. Why is it that we can set the dispersion parameter in the logit probabilities to one?

Suppose that a choice set consists of two alternatives, travel by car ($c$) and travel by blue bus ($bb$). The utilities of these two modes are the same, that is:
$$
V_c = V_{bb}
$$

3. What are the probabilities of choosing these two modes? 

Suppose that the transit operator decides to introduce a new service, namely a red bus. This red bus is identical to the blue bus in every respect except the color. 

4. Under these new conditions, what are the logit probabilities of choosing these modes?

5. Discuss the results of introducing a new mode in the choice process above.